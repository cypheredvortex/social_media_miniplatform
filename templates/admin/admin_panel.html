{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Panel â€“ Social Media</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
</head>
<body class="bg-gray-100 font-sans h-screen flex overflow-hidden">

<!-- SIDEBAR -->
<aside class="w-64 bg-white shadow-lg flex-shrink-0 flex flex-col">
    <div class="px-6 py-4 border-b">
        <h2 class="text-2xl font-bold text-indigo-600">Admin Panel</h2>
    </div>
    <nav class="flex-1 px-4 py-6 space-y-2 overflow-y-auto">
        <a href="{% url 'pages:admin_panel' %}" class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-indigo-50 transition text-gray-700 font-medium">
            <i class="fas fa-tachometer-alt"></i> Dashboard
        </a>

        <h3 class="mt-6 mb-2 text-xs text-gray-500 uppercase font-semibold">Users</h3>
        <a href="{% url 'user:admin_user_list' %}" class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-indigo-50 transition text-gray-700">
            <i class="fas fa-users"></i> View Users
        </a>

        <h3 class="mt-6 mb-2 text-xs text-gray-500 uppercase font-semibold">Profiles</h3>
        <a href="{% url 'profil:admin_profile_list' %}" class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-indigo-50 transition text-gray-700">
            <i class="fas fa-id-card"></i> View Profiles
        </a>

        <h3 class="mt-6 mb-2 text-xs text-gray-500 uppercase font-semibold">Content</h3>
        <a href="{% url 'content:admin_content_list' %}" class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-indigo-50 transition text-gray-700">
            <i class="fas fa-file-alt"></i> Manage Content
        </a>

        <h3 class="mt-6 mb-2 text-xs text-gray-500 uppercase font-semibold">Posts</h3>
        <a href="{% url 'post:admin_post_list' %}" class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-indigo-50 transition text-gray-700">
            <i class="fas fa-pen"></i> Manage Posts
        </a>

        <h3 class="mt-6 mb-2 text-xs text-gray-500 uppercase font-semibold">Comments</h3>
        <a href="{% url 'comment:admin_comment_list' %}" class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-indigo-50 transition text-gray-700">
            <i class="fas fa-comments"></i> Manage Comments
        </a>

        <h3 class="mt-6 mb-2 text-xs text-gray-500 uppercase font-semibold">Reports</h3>
        <a href="{% url 'report:admin_report_list' %}" class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-indigo-50 transition text-gray-700">
            <i class="fas fa-flag"></i> Reports
        </a>
    </nav>
</aside>

<!-- MAIN CONTENT -->
<div class="flex-1 flex flex-col overflow-hidden">

    <!-- TOP NAVBAR -->
    <header class="bg-white shadow-md flex justify-between items-center px-6 py-4 flex-shrink-0">
        <h1 class="text-xl font-bold text-gray-800">Dashboard</h1>
        <div class="flex items-center gap-4">
            <button class="relative p-2 rounded-full hover:bg-gray-100 transition">
                <i class="fas fa-bell text-gray-600"></i>
                <span class="absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold px-1.5 py-0.5 rounded-full">
                    {% if messages %}{{ messages|length }}{% else %}0{% endif %}
                </span>
            </button>
            <div class="flex items-center gap-2 bg-gray-100 px-3 py-1 rounded-full">
                <img src="{% static 'images/user-avatar.png' %}" alt="User" class="w-8 h-8 rounded-full">
                <span class="text-gray-700 font-medium">Admin</span>
            </div>
            <a href="{% url 'user:logout' %}" class="bg-indigo-600 text-white px-4 py-2 rounded-full hover:bg-indigo-700 transition font-semibold">Logout</a>
        </div>
    </header>

    <!-- DASHBOARD CONTENT -->
    <main class="flex-1 overflow-y-auto p-6">

        {% if messages %}
            <ul class="mb-6">
                {% for message in messages %}
                    <li class="p-3 rounded mb-2 shadow
                        {% if message.tags == 'error' %}bg-red-100 text-red-700{% endif %}
                        {% if message.tags == 'success' %}bg-green-100 text-green-700{% endif %}">
                        {{ message }}
                    </li>
                {% endfor %}
            </ul>
        {% endif %}

        {% block content %}
        <!-- KPI CARDS -->
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
            <div class="bg-white p-5 rounded-2xl shadow-md flex flex-col justify-between hover:shadow-xl transition transform hover:-translate-y-1">
                <div>
                    <h3 class="text-gray-500 font-medium">Users</h3>
                    <span class="text-2xl font-bold text-gray-800">{{ users_count }}</span>
                </div>
                <i class="fas fa-users text-indigo-500 text-2xl mt-4"></i>
            </div>

            <div class="bg-white p-5 rounded-2xl shadow-md flex flex-col justify-between hover:shadow-xl transition transform hover:-translate-y-1">
                <div>
                    <h3 class="text-gray-500 font-medium">Posts</h3>
                    <span class="text-2xl font-bold text-gray-800">{{ posts_count }}</span>
                </div>
                <i class="fas fa-pen text-pink-500 text-2xl mt-4"></i>
            </div>

            <div class="bg-white p-5 rounded-2xl shadow-md flex flex-col justify-between hover:shadow-xl transition transform hover:-translate-y-1">
                <div>
                    <h3 class="text-gray-500 font-medium">Comments</h3>
                    <span class="text-2xl font-bold text-gray-800">{{ comments_count }}</span>
                </div>
                <i class="fas fa-comments text-green-500 text-2xl mt-4"></i>
            </div>

            <div class="bg-white p-5 rounded-2xl shadow-md flex flex-col justify-between hover:shadow-xl transition transform hover:-translate-y-1">
                <div>
                    <h3 class="text-gray-500 font-medium">Reports</h3>
                    <span class="text-2xl font-bold text-gray-800">{{ reports_count }}</span>
                </div>
                <i class="fas fa-flag text-red-500 text-2xl mt-4"></i>
            </div>
        </div>

        <!-- Recent Users Table -->
        <div class="mt-6 bg-white p-6 rounded-2xl shadow-md">
            <h3 class="text-xl font-semibold mb-4 text-gray-800">Recent Users</h3>
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead>
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Username</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Email</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Role</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200">
                        {% for user in users %}
                        <tr>
                            <td class="px-6 py-4 text-gray-700">{{ user.username }}</td>
                            <td class="px-6 py-4 text-gray-700">{{ user.email }}</td>
                            <td class="px-6 py-4 text-gray-700">{{ user.role }}</td>
                            <td class="px-6 py-4 text-gray-700">{{ user.status }}</td>
                            <td class="px-6 py-4">
                                <a href="{% url 'user:admin_user_detail' user.id %}" class="text-indigo-600 hover:underline mr-2">View</a>
                                <a href="{% url 'user:admin_user_suspend' user.id %}" class="text-yellow-600 hover:underline mr-2">Suspend</a>
                                <a href="{% url 'user:admin_user_ban' user.id %}" class="text-red-600 hover:underline">Ban</a>
                            </td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="5" class="px-6 py-4 text-center text-gray-500">No users found.</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
        {% endblock %}

    </main>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const ctx1 = document.getElementById('userActivityChart')?.getContext('2d');
if(ctx1) {
    new Chart(ctx1, {
        type: 'line',
        data: {
            labels: ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'],
            datasets: [{
                label: 'Active Users',
                data: [12, 19, 14, 17, 22, 20, 25],
                borderColor: 'rgba(79, 70, 229, 1)',
                backgroundColor: 'rgba(79, 70, 229, 0.1)',
                fill: true,
                tension: 0.3
            }]
        },
        options: { responsive: true, plugins: { legend: { display: false } } }
    });
}
</script>
</body>
</html>
